<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE table PUBLIC "-//iptel.org//DTD DBSchema V1.0//EN"
  "http://iptel.org/dbschema/dtd/1.0/dbschema.dtd" [

<!ENTITY % entities SYSTEM "entities.xml">
%entities;

]>

<table xmlns:my="http://iptel.org/dbschema/mysql">
    <name>credentials</name>
    <version>6</version>
    <description>
	This table contains credentials assigned to subscribers. Each
	subscriber can have zero or more credentials assigned. The table maps
	credentials identified by username and realm to subscribers identified
	by UUID. The contents of the table is used by digest authentication
	modules of SER and by SERWeb.
    </description>

    <column id="credentials.username">
	<name>auth_username</name>
	<type>string</type>
	<size>&user_len;</size>
	<description>
	    Credentials username. In digest authentication this is the username
	    configured in user agents, in SERWeb this is the login username.
	</description>
    </column>

    <column id="credentials.realm">
	<name>realm</name>
	<type>string</type>
	<size>&realm_len;</size>
	<description>
	    Credentials realm. In digest authentication this is the value of
	    digest realm attribute, in SERWeb this is the part after @ in login
	    username.
	</description>
    </column>

    <column>
	<name>password</name>
	<type>string</type>
	<default></default>
	<size>28</size>
	<description>
	    Plain text password of the subscriber, can be used for both digest
	    (SER) and SERWeb authentication.
	</description>
    </column>

    <column id="credentials.flags">
	<name>flags</name>
	<type>int</type>
	<default>0</default>
	<description>
	    Flags that identify where this particular line of credentials can
	    be used. DIGEST means that the credentials can be used in the
	    digest authentication done by SER. SERWEB means that the
	    credentials can be used in SERWeb login authentication.
	    (ser_use, serweb_use, disabled).
	</description>
    </column>

    <column>
	<name>ha1</name>
	<type>string</type>
	<size>32</size>
	<description>
	    For digest authentication only. This is the H(A1) value calculated
	    as per RFC2617. The value contains an MD5 hash of string
	    concatenated from username,realm, and password: MD5(username:realm:password).
	</description>
    </column>

    <column>
	<name>ha1b</name>
	<type>string</type>
	<default></default>
	<size>32</size>
	<description>
	    Similar to ha1, but username@domain is used as username. This is
	    necessary for user agents that put username@domain into digest
	    username attribute. This is often useful in multi-domain setups
	    because it allows users to explicitly specify the domain they wish
	    to sign in.
	</description>
    </column>

    <column id="credentials.uid">
	<name>uid</name>
	<type>string</type>
	<size>&id_len;</size>
	<description>
	    This is the UID (User ID) identifier of the subscriber the
	    credentials are assigned to. Each uid can have multiple
	    credentials assigned. UIDs of subscribers with no credentials
	    assigned do not appear in this table.
	</description>
    </column>

    <index>
	<unique/>
	<colref linkend="credentials.username"/>
	<colref linkend="credentials.realm"/>
    </index>

    <index>
	<name>uid</name>
	<colref linkend="credentials.uid"/>
    </index>
</table>
