<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE table PUBLIC "-//iptel.org//DTD DBSchema V1.0//EN" 
  "http://iptel.org/dbschema/dtd/1.0/dbschema.dtd" [

<!ENTITY % entities SYSTEM "entities.xml">
%entities;

]>

<table xmlns:db="http://docbook.org/ns/docbook"
    xmlns:my="http://iptel.org/dbschema/mysql"
    xmlns:pg="http://iptel.org/dbschema/postgres"
    xmlns:dt="http://iptel.org/dbschema/dbtext">
    <name>missed_calls</name>
    <version>3</version>

    <column id="mc.id">
	<name>id</name>
	<type>int</type>
	<my:type>INT AUTO_INCREMENT</my:type>
	<pg:type>SERIAL</pg:type>
	<dt:type>int,auto</dt:type>
	<description>
	    ID that uniquely identifies every record. Useful for post-processing.
	</description>
    </column>

    <column>
	<name>from_uid</name>
	<type>string</type>
	<size>&id_len;</size>
	<null/>
	<description>
	    The UID (Unique ID) of the originator of transaction (usually caller).
	</description>
    </column>

    <column>
	<name>to_uid</name>
	<type>string</type>
	<size>&id_len;</size>
	<null/>
	<description>
	    The UUID of the user identified by the Request-URI (intended
	    recipient of the transaction).
	</description>
    </column>

    <column>
	<name>to_did</name>
	<type>string</type>
	<size>&id_len;</size>
	<null/>
	<description>
	    The domain id of the callee.
	</description>
    </column>

    <column>
	<name>from_did</name>
	<type>string</type>
	<size>&id_len;</size>
	<null/>
	<description>
	    The domain id of the caller.
	</description>
    </column>

    <column>
	<name>sip_from</name>
	<type>string</type>
	<size>&hf_len;</size>
	<null/>
	<description>
	    The body of the From header field, including display name and all
	    parameters URI and header field parameters.
	</description>
    </column>

    <column>
	<name>sip_to</name>
	<type>string</type>
	<size>&hf_len;</size>
	<null/>
	<description>
	    The body of the To header field, including display name and all
	    parameters URI and header field parameters.
	</description>
    </column>

    <column>
	<name>sip_status</name>
	<type>string</type>
	<size>128</size>
	<null/>
	<description>
	    The status code of the final SIP reply that finished the
	    transaction being accounted.
	</description>
    </column>

    <column>
	<name>sip_method</name>
	<type>string</type>
	<size>&method_len;</size>
	<null/>
	<description>
	    The method of the SIP request that created the transaction being
	    accounted.
	</description>
    </column>

    <column>
	<name>inbound_ruri</name>
	<type>string</type>
	<size>&uri_len;</size>
	<null/>
	<description>
	    Inbound Request-URI. This is the value of the Request-URI as
	    received by SER from the previous (upstream) element (typically
	    generated by the SIP phone of the caller).
	</description>
    </column>

    <column>
	<name>outbound_ruri</name>
	<type>string</type>
	<size>&uri_len;</size>
	<null/>
	<description>
	    Outbound Request-URI. This is the value of the Request-URI when the
	    request leaves SER, i.e. after applying all the modifications and
	    rewrites in the configuration file of SER. The next downstream
	    element (typically the SIP phone of the callee) will see exactly
	    this value of the Request-URI.
	</description>
    </column>

    <column>
	<name>from_uri</name>
	<type>string</type>
	<size>&uri_len;</size>
	<null/>
	<description>
	    The SIP URI extracted from From header field. This is just the
	    plain SIP URI without display name and header field parameters
	    (if From header field contains angle brackets then this
	    column contains the string between the angle brackets).
	</description>
    </column>

    <column>
	<name>to_uri</name>
	<type>string</type>
	<size>&uri_len;</size>
	<null/>
	<description>
	    The SIP URI extracted from To header field. This is just the plain
	    SIP URI without display name and header field parameters (if To
	    header field contains angle brackets then this column contains the
	    string between the angle brackets).
	</description>
    </column>

    <column id="mc.sip_callid">
	<name>sip_callid</name>
	<type>string</type>
	<size>&uri_len;</size>
	<null/>
	<description>
	    The value of the Call-ID header field. This value uniquely
	    identifies a call.
	</description>
    </column>

    <column id="mc.sip_cseq">
	<name>sip_cseq</name>
	<type>int</type>
	<null/>
	<description>
	    CSeq number.
	</description>
    </column>

    <column id="mc.username">
	<name>digest_username</name>
	<type>string</type>
	<size>&user_len;</size>
	<null/>
	<description>
	    The value of username attribute from digest credentials
	</description>
    </column>

    <column id="mc.realm">
	<name>digest_realm</name>
	<type>string</type>
	<size>&uri_len;</size>
	<null/>
	<description>
	    Digest realm.
	</description>
    </column>

    <column>
	<name>from_tag</name>
	<type>string</type>
	<size>128</size>
	<null/>
	<description>
	    The value of the tag parameter in From header field.
	</description>
    </column>

    <column>
	<name>to_tag</name>
	<type>string</type>
	<size>128</size>
	<null/>
	<description>
	    The value of the tag parameter in To header field.
	</description>
    </column>

    <column>
	<name>request_timestamp</name>
	<type>datetime</type>
	<description>
	    The date and time of the request arrival to the proxy.
	</description>
    </column>

    <column>
	<name>response_timestamp</name>
	<type>datetime</type>
	<description>
	    The date and time when the final response was sent out.
	</description>
    </column>

    <column>
	<name>flags</name>
	<type>unsigned int</type>
	<default>0</default>
	<description>
	    Various flags (caller_deleted, callee_deleted).
	</description>
    </column>

    <column>
	<name>attrs</name>
	<type>string</type>
	<size>255</size>
	<null/>
	<description>
	    Attribute-value pairs.
	</description>
    </column>

    <index>
	<name>id_key</name>
	<unique/>
	<colref linkend="mc.id"/>
    </index>

    <index role="serweb">
	<name>cid_key</name>
	<colref linkend="mc.sip_callid"/>
    </index>
</table>
